import Tabs from '@theme/Tabs';
import TabItem from '@theme/TabItem';
import CollapsibleApiParam from '@site/src/components/CollapsibleApiParam';
import CollapsibleNestedParams from '@site/src/components/CollapsibleNestedParams';
import ApiParam from '@site/src/components/ApiParam';

<div className="main-container-endpoint">
    <div className="container-endpoint">
            <div className="container-method-post">
                <span className="endpoint-method">POST</span>
            </div>
              <div className="container-url">
                <span className="endpoint-url">/ver1/accounts/new</span>
           </div>
    </div>
    <div className="container-permission">
        <span className="permission-description"><strong>Permission: </strong>ACCOUNTS_WRITE</span>
        <span className="permission-description"><strong>Security: </strong>SIGNED</span>
    </div>
</div>

<p className="p-method-discription">
   Adds a new exchange account. 
</p>

<div class="alert alert--warning" role="alert">
Please note that connections using manually created API keys are available only to Expert plan subscribers and exclusively for Binance sub-accounts.
</div>



<h2>Body Parameters</h2>

<ApiParam name='type' type='string' id="type" required>
   3Commas of exchange code entity
</ApiParam>

<ApiParam name='name' type='string' id="name" required>
   Name of this exchange account
</ApiParam>

<ApiParam name='api_key' type="string" id="api_key" required>
   API-key from this exchange account
</ApiParam>

<ApiParam name='secret' type='string' id="secret" required>
   Secret-key from this exchange account
</ApiParam>

<ApiParam name='address' type='string' id="address" required>
   Address of wallet. This parameter is required when <code>type</code> is set to <code>ethereumwallet</code>
</ApiParam>

<ApiParam name='customer_id' type='string' id="customer_id" required>
    <p>Unique customer ID provided by the Bitstamp exchange.</p>
    <p>This parameter is required when <code>type</code> is set to <code>Bitstamp</code></p>
</ApiParam>

<ApiParam name='passphrase' type='string' id="passphrase" required>
   <p>Secret phrase from this exchange account.</p>
   <p>This parameter is required when <code>type</code> is set to <code>Coinbase</code></p>
</ApiParam>

<ApiParam name='types_to_create' type='array[string]' id="types_to_create" required>
   <p>Array of related account types to be created.</p>
   <p>For example: [<code>binance_margin</code>]</p>
</ApiParam>



<h2>Response Parameters</h2>

<CollapsibleApiParam name="id" type="integer" id="id">
   ID of the exchange account entity
</CollapsibleApiParam>

<CollapsibleApiParam name="name" type="string" id="name">
   The name for the exchange account defined by the user
</CollapsibleApiParam>

<CollapsibleApiParam name="exchange_name" type="string" id="exchange_name">
   Name of this exchange account
</CollapsibleApiParam>

<CollapsibleApiParam name="market_icon" type="string" id="market_icon">
   The URL link to the icon for this exchange
</CollapsibleApiParam>

<CollapsibleApiParam name="market_code" type="string" id="market_code">
   3Commas of exchange code entity
</CollapsibleApiParam>

<CollapsibleApiParam name="auto_balance_period" type="integer" id="auto_balance_period">
   The interval, in hours, at which automatic portfolio balancing occurs
</CollapsibleApiParam>

<CollapsibleApiParam name="auto_balance_portfolio_id" type="integer" id="auto_balance_portfolio_id">
   ID of the portfolio for which automatic balancing has been initiated
</CollapsibleApiParam>

<CollapsibleApiParam name="autobalance_enabled" type="boolean" id="autobalance_enabled">
   Indicates whether auto balance mode is enabled for this account (<code>true</code>) or not (<code>false</code>)
</CollapsibleApiParam>

<CollapsibleApiParam name="auto_balance_error" type="string or null" id="auto_balance_error">
   A description comes up to explain why autobalance failed
</CollapsibleApiParam>

<CollapsibleApiParam name="last_auto_balance" type="string or null" id="last_auto_balance">
   ISO 8601 datetime of when this Auto balance was last time
</CollapsibleApiParam>

<CollapsibleApiParam name="hedge_mode_available" type="boolean" id="hedge_mode_available">
   Indicates whether hedge mode is available for this account (<code>true</code>) or not (<code>false</code>)
</CollapsibleApiParam>

<CollapsibleApiParam name="hedge_mode_enabled" type="boolean" id="hedge_mode_enabled">
   Indicates whether hedge mode is enabled for this account (<code>true</code>) or not (<code>false</code>)
</CollapsibleApiParam>

<CollapsibleApiParam name="is_locked" type="boolean" id="is_locked">
   Indicates if the account is locked (<code>true</code>) or not (<code>false</code>)
</CollapsibleApiParam>

<CollapsibleApiParam name="lock_reason" type="string or null" id="lock_reason">
   The reason for locking this account when <code>is_locked</code> is <code>true</code>
</CollapsibleApiParam>

<CollapsibleApiParam name="smart_trading_supported" type="boolean" id="smart_trading_supported">
   Indicates if smart trading is supported (<code>true</code>) or not (<code>false</code>)
</CollapsibleApiParam>

<CollapsibleApiParam name="stats_supported" type="boolean" id="stats_supported">
   Indicates whether statistic of profit are supported for this account (<code>true</code>) or not (<code>false</code>)
</CollapsibleApiParam>

<CollapsibleApiParam name="trading_supported" type="boolean" id="trading_supported">
   Indicates if trading is supported at 3Commas (<code>true</code>) or not (<code>false</code>)
</CollapsibleApiParam>

<CollapsibleApiParam name="market_buy_supported" type="boolean" id="market_buy_supported">
   Indicates whether creating a market buy order is supported on the exchange (<code>true</code>) or not (<code>false</code>)
</CollapsibleApiParam>

<CollapsibleApiParam name="market_sell_supported" type="boolean" id="market_sell_supported">
   Indicates whether creating a market sell order is supported on the exchange (<code>true</code>) or not (<code>false</code>)
</CollapsibleApiParam>

<CollapsibleApiParam name="conditional_buy_supported" type="boolean" id="conditional_buy_supported">
   Indicates whether creating a conditional buy order is supported on the exchange (<code>true</code>) or not (<code>false</code>)
</CollapsibleApiParam>

<CollapsibleApiParam name="bots_allowed" type="boolean" id="bots_allowed">
   Indicates whether DCA Bot is enabled for this account (<code>true</code>) or not (<code>false</code>)
</CollapsibleApiParam>

<CollapsibleApiParam name="bots_ttp_allowed" type="boolean" id="bots_ttp_allowed">
   Indicates whether the trailing take profit feature is enabled on this account (<code>true</code>) or not (<code>false</code>)
</CollapsibleApiParam>

<CollapsibleApiParam name="bots_tsl_allowed" type="boolean" id="bots_tsl_allowed">
   Indicates whether the trading stop loss feature is enabled on this account (<code>true</code>) or not (<code>false</code>)
</CollapsibleApiParam>

<CollapsibleApiParam name="multi_bots_allowed" type="boolean" id="multi_bots_allowed">
   Indicates whether the Multi-Pair feature is supported for this account (<code>true</code>) or not (<code>false</code>)
</CollapsibleApiParam>

<CollapsibleApiParam name="fast_convert_available" type="boolean" id="fast_convert_available">
   Indicates whether the <a href="https://help.3commas.io/en/articles/5898691-rebalance-your-portfolio-with-sell-all-to-usdt-or-sell-all-to-btc">Sell All to BTC/USD</a> feature is enabled for this account (<code>true</code>) or not (<code>false</code>)
</CollapsibleApiParam>

<CollapsibleApiParam name="grid_bots_allowed" type="boolean" id="grid_bots_allowed">
   Indicates whether Grid Bot is enabled for this account (<code>true</code>) or not (<code>false</code>)
</CollapsibleApiParam>

<CollapsibleApiParam name="api_key" type="string" id="api_key">
   API key used for the account
</CollapsibleApiParam>

<CollapsibleApiParam name="api_key_invalid" type="boolean" id="api_key_invalid">
   Indicates whether the API key for this account is invalid (<code>true</code>) or not (<code>false</code>)
</CollapsibleApiParam>

<CollapsibleApiParam name="api_keys_state" type="string" id="api_keys_state">
   Indicates the state of the API keys
</CollapsibleApiParam>

<CollapsibleApiParam name="deposit_enabled" type="boolean" id="deposit_enabled">
   Indicates whether the Deposit feature is enabled for this account (<code>true</code>) or not (<code>false</code>)
</CollapsibleApiParam>

<CollapsibleApiParam name="available_include_in_summary" type="boolean" id="available_include_in_summary">
   Indicates whether this account is available to be included in the summary (<code>true</code>) or not (<code>false</code>)
</CollapsibleApiParam>

<CollapsibleApiParam name="include_in_summary" type="boolean" id="include_in_summary">
   Indicates whether this account included in the summary (<code>true</code>) or not (<code>false</code>)
</CollapsibleApiParam>

<CollapsibleApiParam name="supported_market_types" type="array" id="supported_market_types">
   The type of market supported by the connected exchange account
</CollapsibleApiParam>

<CollapsibleApiParam name="customer_id" type="string" id="customer_id">
   Unique customer ID provided by the Bitstamp exchange
</CollapsibleApiParam>

<CollapsibleApiParam name="btc_amount" type="string" id="btc_amount">
   Amount of Bitcoin in the account
</CollapsibleApiParam>

<CollapsibleApiParam name="usd_amount" type="string" id="usd_amount">
   Amount in USD in the account
</CollapsibleApiParam>

<CollapsibleApiParam name="day_profit_btc" type="string" id="day_profit_btc">
   Daily profit in BTC
</CollapsibleApiParam>

<CollapsibleApiParam name="day_profit_usd" type="string" id="day_profit_usd">
   Daily profit in USD
</CollapsibleApiParam>

<CollapsibleApiParam name="day_profit_btc_percentage" type="number" id="day_profit_btc_percentage">
   Daily profit percentage in BTC
</CollapsibleApiParam>

<CollapsibleApiParam name="day_profit_usd_percentage" type="number" id="day_profit_usd_percentage">
   Daily profit percentage in USD
</CollapsibleApiParam>

<CollapsibleApiParam name="btc_profit" type="number" id="btc_profit">
   Monthly profit in BTC
</CollapsibleApiParam>

<CollapsibleApiParam name="usd_profit" type="number" id="usd_profit">
   Monthly profit in USD
</CollapsibleApiParam>

<CollapsibleApiParam name="btc_profit_percentage" type="number" id="btc_profit_percentage">
   Monthly profit percentage in BTC
</CollapsibleApiParam>

<CollapsibleApiParam name="usd_profit_percentage" type="number" id="usd_profit_percentage">
   Monthly profit percentage in USD
</CollapsibleApiParam>

<CollapsibleApiParam name="total_btc_profit" type="number" id="total_btc_profit">
   Total profit in BTC
</CollapsibleApiParam>

<CollapsibleApiParam name="total_usd_profit" type="number" id="total_usd_profit">
   Total profit in USD
</CollapsibleApiParam>

<CollapsibleApiParam name="created_at" type="string" id="created_at">
   ISO 8601 datetime of when this Account entity was created
</CollapsibleApiParam>

<CollapsibleApiParam name="updated_at" type="string" id="updated_at">
   ISO 8601 datetime of when this SmartTrade entity was updated
</CollapsibleApiParam>

<h3> Example Request</h3>

```json title="POST /ver1/accounts/new"
{
    "type": "binance",
    "name": "New account",
    "api_key": "6q4zuONXKixxxxxxx3K46W34w...",
    "secret": "7CfL1slTgxxxxxxxPDfoJSPxxxxIsOFx..."
}
```


<h3> Example Response and errors </h3>
<div style={{ margin: '10px', padding: '10px' }}>
<Tabs>
  <TabItem value="200 OK" label="200 OK" attributes={{className: "green"}}>

    ```json
{
    "id": 32849081,
    "auto_balance_period": 12,
    "auto_balance_portfolio_id": null,
    "auto_balance_currency_change_limit": null,
    "autobalance_enabled": false,
    "hedge_mode_available": false,
    "hedge_mode_enabled": false,
    "is_locked": false,
    "smart_trading_supported": true,
    "stats_supported": true,
    "trading_supported": true,
    "market_buy_supported": true,
    "market_sell_supported": true,
    "conditional_buy_supported": true,
    "bots_allowed": true,
    "bots_ttp_allowed": false,
    "bots_tsl_allowed": true,
    "gordon_bots_available": true,
    "multi_bots_allowed": true,
    "created_at": "2024-09-17T23:55:19.607Z",
    "updated_at": "2024-09-17T23:55:19.607Z",
    "last_auto_balance": null,
    "fast_convert_available": true,
    "grid_bots_allowed": true,
    "api_key_invalid": false,
    "market_icon": "https://3commas.io/img/exchanges/okex.png",
    "deposit_enabled": true,
    "include_in_summary": true,
    "supported_market_types": [
        "spot"
    ],
    "primary_display_currency_profit_percentage": {
        "currency": "USD",
        "amount": "-0.0"
    },
    "primary_display_currency_profit": {
        "currency": "USD",
        "amount": "-0.00000000000000000010999999999999999999993138892165683112"
    },
    "day_profit_primary_display_currency_percentage": {
        "currency": "USD",
        "amount": "-0.0"
    },
    "day_profit_primary_display_currency": {
        "currency": "USD",
        "amount": "-0.00000000000000000010999999999999999999993138892165683112"
    },
    "primary_display_currency_amount": {
        "currency": "USD",
        "amount": "0.00048395892787478689000000000000000000006861107834316888"
    },
    "total_primary_display_currency_profit": {
        "currency": "USD",
        "amount": -1.1e-19
    },
    "available_include_in_summary": true,
    "api_key": "4ce4943c-f478-46c3-b50b-70de4d1bc34d",
    "name": "test",
    "auto_balance_method": null,
    "auto_balance_error": null,
    "customer_id": null,
    "subaccount_name": null,
    "lock_reason": null,
    "btc_amount": "0.0000000080232449796548201579586071525673247181448663178",
    "usd_amount": "0.00048395892787478689000000000000000000006861107834316888",
    "day_profit_btc": "0.0000000000000000000000001579586071525673247181448663178",
    "day_profit_usd": "-0.00000000000000000010999999999999999999993138892165683112",
    "day_profit_btc_percentage": "0.0",
    "day_profit_usd_percentage": "-0.0",
    "btc_profit": "0.0000000000000000000000001579586071525673247181448663178",
    "usd_profit": "-0.00000000000000000010999999999999999999993138892165683112",
    "usd_profit_percentage": "-0.0",
    "btc_profit_percentage": "0.0",
    "total_btc_profit": "1.5795860715256732e-25",
    "total_usd_profit": "-1.1e-19",
    "pretty_display_type": "Okex",
    "exchange_name": "OKX Spot",
    "market_code": "okex",
    "api_keys_state": "ok"
}
```
  </TabItem>
  <TabItem value="400 Bad request" label="400 Bad request" attributes={{className: "red"}}>

    ```json
{
    "error": "record_invalid",
    "error_description": "Invalid parameters",
    "error_attributes": {
        "api_key": [
            "This account is already connected!"
        ]
    }
}
```
  </TabItem>
</Tabs>
</div>
